(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14380,        456]
NotebookOptionsPosition[     11950,        391]
NotebookOutlinePosition[     12306,        407]
CellTagsIndexPosition[     12263,        404]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", "sw_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"sw", "^", "2"}], "/", "phi"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"sw", "^", "2"}], " ", "+", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "sw"}], ")"}], "^", "2"}], "*", 
      RowBox[{"muw", "/", "muo"}]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.732869240794199*^9, 3.73286924555905*^9}, {
   3.732869319582374*^9, 3.732869345550112*^9}, {3.732869397365831*^9, 
   3.732869420158765*^9}, 
   3.732869835331029*^9},ExpressionUUID->"3c61f35a-b755-45f5-b649-\
45adc1aa30f5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"f", "[", "sw", "]"}], ",", " ", "sw"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.732869349021751*^9, 
  3.7328693662156267`*^9}},ExpressionUUID->"030cd932-4fb1-4400-99a9-\
4a5f9858f8c6"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"2", " ", "muo", " ", "muw", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "sw"}], ")"}], " ", "sw"}], 
   RowBox[{"phi", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"muw", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "sw"}], ")"}], "2"]}], "+", 
       RowBox[{"muo", " ", 
        SuperscriptBox["sw", "2"]}]}], ")"}], "2"]}]]}]], "Output",
 CellChangeTimes->{{3.732869355519813*^9, 3.732869367012561*^9}, 
   3.732869423552795*^9},ExpressionUUID->"23a632f2-7605-41b2-85b2-\
a95311b3c85b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"hmean", "[", 
   RowBox[{"a_", ",", " ", "b_"}], "]"}], " ", ":=", " ", 
  RowBox[{"2", "*", "a", "*", 
   RowBox[{"b", "/", 
    RowBox[{"(", 
     RowBox[{"a", "+", "b"}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7328697856441393`*^9, 
  3.732869801659514*^9}},ExpressionUUID->"a9ffe9a4-b898-46e0-8b69-\
be25933f186e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"hmean", "[", 
     RowBox[{"a", ",", " ", "b"}], "]"}], ",", " ", "b"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.733028617053545*^9, 
  3.733028645988908*^9}},ExpressionUUID->"085d25eb-7878-42af-9b6c-\
39151efe675f"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   SuperscriptBox["a", "2"]}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"a", "+", "b"}], ")"}], "2"]]], "Output",
 CellChangeTimes->{
  3.7330286468073874`*^9},ExpressionUUID->"2bebc656-e850-4002-bfea-\
16e5bf19fe3f"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lambda", "[", 
   RowBox[{"sw_", ",", " ", "lnk_"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"Exp", "[", "lnk", "]"}], " ", "*", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "sw"}], ")"}], "^", "2"}], "/", "muo"}], " ", "+", 
     " ", 
     RowBox[{
      RowBox[{"sw", "^", "2"}], "/", "muw"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", 
  RowBox[{"lambda", ",", " ", "hmean"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7328698281218243`*^9, 3.732869883872843*^9}, {
   3.732870167667646*^9, 3.732870172657856*^9}, 3.7328712160267773`*^9, {
   3.733028170290901*^9, 3.733028185297578*^9}, {3.7330283509339743`*^9, 
   3.733028356700862*^9}, {3.73302849411451*^9, 
   3.733028495264436*^9}},ExpressionUUID->"78b3c9dd-837e-49d7-9034-\
51a0dc085d7a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"T", "[", 
   RowBox[{"swa_", ",", " ", "swb_", ",", " ", "lnka_", ",", " ", "lnkb_"}], 
   "]"}], " ", ":=", " ", 
  RowBox[{"hmean", "[", 
   RowBox[{
    RowBox[{"lambda", "[", 
     RowBox[{"swa", ",", " ", "lnka"}], "]"}], ",", " ", 
    RowBox[{"lambda", "[", 
     RowBox[{"swb", ",", " ", "lnkb"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.732869914553637*^9, 3.732869952311324*^9}, {
  3.733028192370133*^9, 
  3.733028222671603*^9}},ExpressionUUID->"9ef741a7-f0c8-40e0-81ea-\
d7d301fb57a2"],

Cell[BoxData[
 RowBox[{"pressureConstraint", " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"T", "[", 
     RowBox[{"swl", ",", " ", "swk", ",", " ", "lnkl", ",", " ", "lnkk"}], 
     "]"}], "*", 
    RowBox[{"(", 
     RowBox[{"pk", " ", "-", " ", "pl"}], ")"}]}], " ", "+", " ", 
   RowBox[{
    RowBox[{"T", "[", 
     RowBox[{"swr", ",", " ", "swk", ",", " ", "lnkr", ",", " ", "lnkk"}], 
     "]"}], "*", 
    RowBox[{"(", 
     RowBox[{"pk", " ", "-", " ", "pr"}], ")"}]}], " ", "+", " ", 
   RowBox[{
    RowBox[{"T", "[", 
     RowBox[{"swu", ",", " ", "swk", ",", " ", "lnku", ",", " ", "lnkk"}], 
     "]"}], "*", 
    RowBox[{"(", 
     RowBox[{"pk", " ", "-", " ", "pu"}], ")"}]}], " ", "+", " ", 
   RowBox[{
    RowBox[{"T", "[", 
     RowBox[{"swd", ",", " ", "swk", ",", " ", "lnkd", ",", " ", "lnkk"}], 
     "]"}], "*", 
    RowBox[{"(", 
     RowBox[{"pk", " ", "-", " ", "pd"}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7328699908520193`*^9, 3.7328700954683123`*^9}, {
  3.733028229178958*^9, 3.73302828902313*^9}, {3.7330285630427027`*^9, 
  3.733028565680244*^9}},ExpressionUUID->"7b36a369-1dc9-4930-82a8-\
203f189d0b1c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"D", "[", 
    RowBox[{"pressureConstraint", ",", " ", "lnkl"}], "]"}], "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.732870098388587*^9, 3.732870125089869*^9}, {
  3.732870184735718*^9, 3.7328702254403973`*^9}, {3.732870266466818*^9, 
  3.7328702741194887`*^9}, {3.733028294986184*^9, 3.733028295558766*^9}, {
  3.733029326951962*^9, 
  3.733029327709408*^9}},ExpressionUUID->"5313eccb-2a96-43ff-a55a-\
d47ee57f54a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"pk", "-", "pl"}], ")"}], " ", 
  RowBox[{
   SuperscriptBox["lambda", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"0", ",", "1"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"swl", ",", "lnkl"}], "]"}], " ", 
  RowBox[{
   SuperscriptBox["hmean", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"1", ",", "0"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{
    RowBox[{"lambda", "[", 
     RowBox[{"swl", ",", "lnkl"}], "]"}], ",", 
    RowBox[{"lambda", "[", 
     RowBox[{"swk", ",", "lnkk"}], "]"}]}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.7328701055578003`*^9, 3.732870187291789*^9, {3.732870226071805*^9, 
   3.7328702402380753`*^9}, 3.7328702805393972`*^9, 3.7330283712089863`*^9, 
   3.733028461325811*^9, 3.733028502107789*^9, 3.7330285688006277`*^9, {
   3.733029330588485*^9, 
   3.733029336733923*^9}},ExpressionUUID->"7206a949-0c6e-4a13-8a90-\
79941fd51940"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"lambda", "[", "sw", "]"}], ",", " ", "sw"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.732871196232175*^9, 
  3.732871208490144*^9}},ExpressionUUID->"e7661b80-fe98-4504-ba02-\
280b81537db0"],

Cell[BoxData[
 RowBox[{"2", " ", "k", " ", 
  RowBox[{"(", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"-", "1"}], "+", "sw"}], "muo"], "+", 
    FractionBox["sw", "muw"]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.732871209082905*^9, 
  3.732871219610009*^9}},ExpressionUUID->"31709d8f-c3e6-4a47-b7a0-\
1ea612afbc0b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "lambda", "]"}]], "Input",
 CellChangeTimes->{{3.732871560943013*^9, 
  3.732871565462512*^9}},ExpressionUUID->"569b7360-5313-4bce-8abd-\
a107075adfd8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"pressureConstraint", ",", " ", "lnkk"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.732871547410276*^9, 3.7328715475119963`*^9}, {
  3.733031047481427*^9, 
  3.733031063654819*^9}},ExpressionUUID->"c0f42fc0-ba60-4828-b2d9-\
68407a26b221"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "pd"}], "+", "pk"}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["hmean", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{
       RowBox[{"lambda", "[", 
        RowBox[{"swd", ",", "lnkd"}], "]"}], ",", 
       RowBox[{"lambda", "[", 
        RowBox[{"swk", ",", "lnkk"}], "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"pk", "-", "pl"}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["hmean", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{
       RowBox[{"lambda", "[", 
        RowBox[{"swl", ",", "lnkl"}], "]"}], ",", 
       RowBox[{"lambda", "[", 
        RowBox[{"swk", ",", "lnkk"}], "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"pk", "-", "pr"}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["hmean", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{
       RowBox[{"lambda", "[", 
        RowBox[{"swr", ",", "lnkr"}], "]"}], ",", 
       RowBox[{"lambda", "[", 
        RowBox[{"swk", ",", "lnkk"}], "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"pk", "-", "pu"}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["hmean", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{
       RowBox[{"lambda", "[", 
        RowBox[{"swu", ",", "lnku"}], "]"}], ",", 
       RowBox[{"lambda", "[", 
        RowBox[{"swk", ",", "lnkk"}], "]"}]}], "]"}]}]}], ")"}], " ", 
  RowBox[{
   SuperscriptBox["lambda", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"0", ",", "1"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"swk", ",", "lnkk"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.732871549237563*^9, 3.7328715678276367`*^9}, {
  3.733031048474455*^9, 
  3.73303106465093*^9}},ExpressionUUID->"8356122b-e9e0-4a1d-8aca-\
36a730b56540"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"pressureConstraint", ",", " ", "lnk"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.733028086507368*^9, 
  3.733028087980966*^9}},ExpressionUUID->"e3ec01e8-cc2c-4e7e-b151-\
dfa58a69bf2b"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.7330280986793823`*^9},ExpressionUUID->"b8c416b7-19c5-4391-a9eb-\
9da48156b03a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"lambdaAlt", "[", "lnk_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"Exp", "[", "lnk", "]"}], " ", "*", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", ")"}], "^", "2"}], "/", "muo"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"sw", "^", "2"}], "/", "muw"}]}], ")"}], " "}]}]], "Input",
 CellChangeTimes->{{3.7330281059256363`*^9, 3.73302813021164*^9}, 
   3.733028162467969*^9},ExpressionUUID->"5e066f53-a4d9-42f5-b5e7-\
510e74721938"],

Cell[BoxData[
 RowBox[{"pressureConstraintAlt", " ", ":=", " "}]], "Input",
 CellChangeTimes->{{3.733028141964054*^9, 
  3.733028145102707*^9}},ExpressionUUID->"44734e29-1c6d-4b7b-af80-\
d5bcdeb1e8ed"]
},
WindowSize->{808, 674},
WindowMargins->{{222, Automatic}, {Automatic, 39}},
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 18, \
2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 641, 18, 32, "Input", "ExpressionUUID" -> \
"3c61f35a-b755-45f5-b649-45adc1aa30f5"],
Cell[CellGroupData[{
Cell[1224, 42, 282, 7, 32, "Input", "ExpressionUUID" -> \
"030cd932-4fb1-4400-99a9-4a5f9858f8c6"],
Cell[1509, 51, 663, 20, 55, "Output", "ExpressionUUID" -> \
"23a632f2-7605-41b2-85b2-a95311b3c85b"]
}, Open  ]],
Cell[2187, 74, 359, 10, 32, "Input", "ExpressionUUID" -> \
"a9ffe9a4-b898-46e0-8b69-be25933f186e"],
Cell[CellGroupData[{
Cell[2571, 88, 316, 9, 32, "Input", "ExpressionUUID" -> \
"085d25eb-7878-42af-9b6c-39151efe675f"],
Cell[2890, 99, 273, 9, 55, "Output", "ExpressionUUID" -> \
"2bebc656-e850-4002-bfea-16e5bf19fe3f"]
}, Open  ]],
Cell[3178, 111, 883, 23, 54, "Input", "ExpressionUUID" -> \
"78b3c9dd-837e-49d7-9034-51a0dc085d7a"],
Cell[4064, 136, 543, 14, 32, "Input", "ExpressionUUID" -> \
"9ef741a7-f0c8-40e0-81ea-d7d301fb57a2"],
Cell[4610, 152, 1152, 30, 75, "Input", "ExpressionUUID" -> \
"7b36a369-1dc9-4930-82a8-203f189d0b1c"],
Cell[CellGroupData[{
Cell[5787, 186, 506, 11, 54, "Input", "ExpressionUUID" -> \
"5313eccb-2a96-43ff-a55a-d47ee57f54a8"],
Cell[6296, 199, 985, 30, 32, "Output", "ExpressionUUID" -> \
"7206a949-0c6e-4a13-8a90-79941fd51940"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7318, 234, 288, 8, 32, "Input", "ExpressionUUID" -> \
"e7661b80-fe98-4504-ba02-280b81537db0"],
Cell[7609, 244, 333, 10, 49, "Output", "ExpressionUUID" -> \
"31709d8f-c3e6-4a47-b7a0-1ea612afbc0b"]
}, Open  ]],
Cell[7957, 257, 192, 4, 32, "Input", "ExpressionUUID" -> \
"569b7360-5313-4bce-8abd-a107075adfd8"],
Cell[CellGroupData[{
Cell[8174, 265, 319, 7, 32, "Input", "ExpressionUUID" -> \
"c0f42fc0-ba60-4828-b2d9-68407a26b221"],
Cell[8496, 274, 2279, 76, 134, "Output", "ExpressionUUID" -> \
"8356122b-e9e0-4a1d-8aca-36a730b56540"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10812, 355, 267, 6, 32, "Input", "ExpressionUUID" -> \
"e3ec01e8-cc2c-4e7e-b151-dfa58a69bf2b"],
Cell[11082, 363, 132, 3, 32, "Output", "ExpressionUUID" -> \
"b8c416b7-19c5-4391-a9eb-9da48156b03a"]
}, Open  ]],
Cell[11229, 369, 513, 14, 32, "Input", "ExpressionUUID" -> \
"5e066f53-a4d9-42f5-b5e7-510e74721938"],
Cell[11745, 385, 201, 4, 32, "Input", "ExpressionUUID" -> \
"44734e29-1c6d-4b7b-af80-d5bcdeb1e8ed"]
}
]
*)

