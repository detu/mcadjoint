\documentclass[conference]{IEEEtran}
\IEEEoverridecommandlockouts
% The preceding line is only needed to identify funding in the first footnote. If that is unneeded, please comment it out.
\usepackage{cite}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{algorithmic}
\usepackage{graphicx}
\usepackage{textcomp}
\usepackage{bm}
\usepackage{empheq}
\usepackage{hyperref}
\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
    
    
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\grad}{grad}
\let\div\undefined
\DeclareMathOperator*{\div}{div}

\newcommand*{\E}[1]{\ensuremath{\mathbb{E}\left[#1\right]}}
\renewcommand*{\P}[2][]{\ensuremath{\mathbb{P}#1\left(#2\right)}}
\newcommand*{\Var}[1]{\ensuremath{\text{Var}\left(#1\right)}}
\newcommand*{\Cov}[2]{\ensuremath{\text{Cov}\left({#1}, {#2}\right)}}
\newcommand*{\Corr}[1]{\ensuremath{\text{Corr}\left(#1\right)}}
\newcommand*{\sd}[1]{\ensuremath{\sigma_{#1}}}
\newcommand*{\card}[1]{\ensuremath{\lvert#1\rvert}}
\newcommand*{\warn}[1]{\textcolor{OrangeRed}{#1}}
\newcommand*{\important}[1]{\fcolorbox{BurntOrange}{BurntOrange!10!White}{\begin{varwidth}{\textwidth}
#1
\end{varwidth}}}
\renewcommand*{\d}[1]{\ensuremath{\mathrm{d}#1}}
\newcommand*{\dist}{\sim}
\newcommand*{\reals}{\ensuremath{\mathbb{R}}}
\newcommand*{\integers}{\ensuremath{\mathbb{Z}}}
\newcommand*{\naturals}{\ensuremath{\mathbb{N}}}
\newcommand*{\abs}[1]{\ensuremath{\left\lvert#1\right\rvert}}
\newcommand*{\floor}[1]{\ensuremath{\lfloor#1\rfloor}}
\newcommand*{\inclimg}[2][]{\begin{figure}[H]\centering\includegraphics[max width=0.9\textwidth,keepaspectratio]{#2}#1\end{figure}}
\newcommand*{\diff}[2]{\ensuremath{\frac{\d}{\d{#2}}{#1}}}
\newcommand*{\pdiff}[2]{\ensuremath{\frac{\partial}{\partial{#2}}{#1}}}

\newcommand*{\mdiff}[3]{\ensuremath{\frac{\d{^{#3}}}{\d{#2}^{#3}}{#1}}}
\newcommand*{\pmdiff}[3]{\ensuremath{\frac{\partial{^{#3}}}{\partial{#2}^{#3}}{#1}}}

\newcommand*{\at}[1]{\ensuremath{\biggr\rvert_{#1}}}
\renewcommand*{\i}{\ensuremath{\text{i}}}
\newcommand{\distlike}{\ensuremath{\sim}}
\newcommand{\normaldist}[2]{\ensuremath{\mathcal{N}\left(#1, #2\right)}}
\newcommand{\asnormaldist}[2]{\distlike\normaldist{#1}{#2}}
\renewcommand*{\vec}[1]{\ensuremath{{\bm{#1}}}}
\newcommand*{\mat}[1]{\vec{#1}}
\newcommand*{\transpose}[1]{{#1}^{\mkern-1.5mu\mathsf{T}}}
\newcommand*{\invert}[1]{{#1}^{-1}}
\newcommand*{\tvec}[1]{\transpose{\vec{#1}}}
\newcommand*{\tmat}[1]{\tvec{#1}}
\newcommand*{\rgramian}[1]{{#1}\transpose{#1}}
\newcommand*{\lgramian}[1]{\transpose{#1}{#1}}
\newcommand*{\indicator}[1]{\ensuremath{\mathbb{1}\left\{#1\right\}}}
\newcommand*{\invmat}[1]{\ensuremath{\invert{\mat{#1}}}}
\newcommand*{\iprod}[3]{\ensuremath{\ifstrempty{#1}{\transpose{#2} {#3}}{\transpose{#1} {#2} {#3}}}}
\newcommand*{\ciprod}[2]{\ensuremath{\left\langle{#1},{#2}\right\rangle}}
\newcommand*{\miprod}[2]{\iprod{#1}{#2}{#1}}
\newcommand*{\enm}[1]{\left\langle{#1}\right\rangle}
%\newcommand*{\grad}{\mathrm{grad}}
%\renewcommand*{\div}{\mathrm{div}}
\newcommand*{\bigO}[1]{\ensuremath{\mathcal{O}\left({#1}\right)}}
\begin{document}

\title{Report for the semester thesis ``Development of a Monte Carlo algorithm for optimal control problems''}

\author{\IEEEauthorblockN{Stefano Weidmann}
\IEEEauthorblockA{\textit{Institute of fluid dynamics} \\
\textit{ETH Zurich}\\
Zurich, Switzerland \\
\href{mailto:stefanow@student.ethz.ch}{stefanow@student.ethz.ch}}}
%\and
%\IEEEauthorblockN{2\textsuperscript{nd} Given Name Surname}
%\IEEEauthorblockA{\textit{dept. name of organization (of Aff.)} \\
%\textit{name of organization (of Aff.)}\\
%City, Country \\
%email address}
%\and
%\IEEEauthorblockN{3\textsuperscript{rd} Given Name Surname}
%\IEEEauthorblockA{\textit{dept. name of organization (of Aff.)} \\
%\textit{name of organization (of Aff.)}\\
%City, Country \\
%email address}
%\and
%\IEEEauthorblockN{4\textsuperscript{th} Given Name Surname}
%\IEEEauthorblockA{\textit{dept. name of organization (of Aff.)} \\
%\textit{name of organization (of Aff.)}\\
%City, Country \\
%email address}
%\and
%\IEEEauthorblockN{5\textsuperscript{th} Given Name Surname}
%\IEEEauthorblockA{\textit{dept. name of organization (of Aff.)} \\
%\textit{name of organization (of Aff.)}\\
%City, Country \\
%email address}
%\and
%\IEEEauthorblockN{6\textsuperscript{th} Given Name Surname}
%\IEEEauthorblockA{\textit{dept. name of organization (of Aff.)} \\
%\textit{name of organization (of Aff.)}\\
%City, Country \\
%email address}
%}

\maketitle

\begin{abstract}
TODO *CRITICAL: Do Not Use Symbols, Special Characters, Footnotes, 
or Math in Paper Title or Abstract.
\end{abstract}

\begin{IEEEkeywords}
a, b, c
\end{IEEEkeywords}

\section{Problem description}
We model a cross section of an oil field as a two dimensional square $\Omega := [0, 1]^2.$ In the oilfield, there are two phases: water and oil. 
At the lower left corner $(0, 0)$, we know the pressure $p(t)$. Opposite of that, at $(1, 1)$ a well is located.
There we can measure the pressure $p_\text{well}(t)$ as well as the total volumetric outflow \[{Q}_\text{tot}(t) := {Q}_\text{o}(t) + {Q}_\text{w}(t)\] per unit depth.

The flow rates for both phases are described by Darcy's law
\begin{equation}
\label{flowrateWater}
\vec{v}_\text{w} = -\frac{k k_\text{rel, w}}{\mu_\text{w}} \grad(p),
\end{equation}
for water and
\begin{equation}
\label{flowrateOil}
\vec{v}_\text{o} = -\frac{k k_\text{rel, o}}{\mu_\text{o}} \grad(p)
\end{equation}
for oil.
Here, $p(\vec{x}, t)$ is the pressure, $\mu_\text{o}$, $\mu_\text{w}$ are dynamic viscosities for oil and water, $k(\vec{x}, t)$ is the permeability.
$k_\text{rel, o}(S)$, $k_\text{rel, w}(S)$ are relative permeabilities and are assumed to depend quadratically on the saturation of water $S_\text{w} \in [0, 1]$ and the saturation of oil $S_\text{o} \in [0, 1]$:
\begin{align}
\label{relativePermeabilityModel}
k_\text{rel, o} &= S_\text{o}^2\\
k_\text{rel, w} &= S_\text{w}^2.
\end{align}
The saturations are linked by the constitutive relation
\begin{equation}
S_\text{o} + S_\text{w} = 1.
\end{equation}

$\vec{v}_\text{o}(\vec{x}, t)$, $\vec{v}_\text{w}(\vec{x}, t)$ finally are the volumetric flow rates per unit area (Darcy velocities).

The saturation $S$ is not assumed constant but instead is transported according to the equation
\begin{equation}
\label{stransp}
\pdiff{\phi S_\text{w}}{t} + \div(\vec{v}_\text{w}) = q_\text{w}.
\end{equation}
The term
\begin{equation}
q_\text{w} := Q_\text{w}\delta(\vec{x} - \begin{pmatrix}1\\1\end{pmatrix})
\end{equation}
describes a line sink of water located at the well.
Similarly, we use
\begin{align}
q_\text{o} &:= Q_\text{o}\delta(\vec{x} - \begin{pmatrix}1\\1\end{pmatrix}) \\
q_\text{tot} &:= q_\text{o} + q_\text{w}.
\end{align}
$\phi$ is the porosity of the rock which is assumed to be constant over the domain.

Conservation of the total mass then reads
\begin{equation}
\label{conservationOfMass}
\div(\vec{v}_\text{tot}) = q_\text{tot},
\end{equation}
where
\begin{equation}
\vec{v}_\text{tot} := \vec{v}_\text{o} + \vec{v}_\text{w}
\end{equation}
is the total Darcy velocity.

We then introduce some additional simplifications:
We set
\begin{equation}
\mu_\text{w} {=} \mu_\text{o} =: \mu,
\end{equation}
and introduce the mobilities
\begin{align}
\label{lambdas}
\lambda_\text{o} &:= \frac{k k_\text{rel, o}}{\mu_\text{o}} \\
\lambda_\text{w} &:= \frac{k k_\text{rel, w}}{\mu_\text{w}} \\
\lambda_\text{tot} &:= \lambda_\text{o} + \lambda_\text{w}.
\end{align}

Substituting in the $\lambda$ from \eqref{lambdas} into Darcy's law \eqref{flowrateOil}, \eqref{flowrateWater} and adding both sides of the results we get the total Darcy's law

\begin{empheq}[box=\fbox]{equation}
\label{flowrateTotal}
\vec{v}_\text{tot} = - \lambda_\text{tot} \grad(p).
\end{empheq}

Plugging this \eqref{flowrateTotal} into the conservation of mass \eqref{conservationOfMass} leads to the pressure equation
\begin{equation}
\div(\lambda_\text{tot}\grad(p)) = q_\text{tot}.
\end{equation}

Comparing the total Darcy's law \eqref{flowrateTotal} and the Darcy's law for water \eqref{flowrateWater}, we see that
\begin{equation}
\vec{v}_\text{w} = \frac{\lambda_\text{w}}{\lambda_\text{tot}} \vec{v}_\text{tot}.
\end{equation}

We then plug in the model for the relative permeabilities in terms of the saturations \eqref{relativePermeabilityModel}, to get the final for of saturation transport equation

\begin{empheq}[box=\fbox]{equation}
\pdiff{S_\text{w}}{t} + \div\left(\vec{F}(S_\text{w}, \vec{v}_\text{tot})\right) = \frac{q_\text{w}}{\phi},
\end{empheq}
where $\vec{F}$ is the flux function
\begin{empheq}[box=\fbox]{equation}
\vec{F}(S_\text{w}, \vec{v}_\text{tot}) := \frac{S_\text{w}^2 / \phi}{S_\text{w}^2 + (1-S_\text{w})^2 \mu_\text{w} / \mu_\text{o}} \vec{v}_\text{tot}.
\end{empheq}


\end{document}
